USE [GD2C2023]
GO

-- Inicio Configurar reglas de nombre de objetos
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET CONCAT_NULL_YIELDS_NULL ON
GO
-- Fin Configurar reglas de nombre de objetos

-- Inicio DROP FKs
IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_DETALLE_IMPORTE_ALQ_ALQUILER_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DETALLE_IMPORTE_ALQ
    DROP CONSTRAINT FK_DETALLE_IMPORTE_ALQ_ALQUILER_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_PAGO_ALQUILER_MEDIO_PAGO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_ALQUILER
    DROP CONSTRAINT FK_PAGO_ALQUILER_MEDIO_PAGO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_PAGO_ALQUILER_ALQUILER_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_ALQUILER
    DROP CONSTRAINT FK_PAGO_ALQUILER_ALQUILER_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_PAGO_VENTA_TIPO_MONEDA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
    DROP CONSTRAINT FK_PAGO_VENTA_TIPO_MONEDA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_PAGO_VENTA_MEDIO_PAGO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
    DROP CONSTRAINT FK_PAGO_VENTA_MEDIO_PAGO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_PAGO_VENTA_VENTA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
    DROP CONSTRAINT FK_PAGO_VENTA_VENTA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_INMUEBLE_ORIENTACION_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    DROP CONSTRAINT FK_INMUEBLE_ORIENTACION_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_INMUEBLE_DISPOSICION_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    DROP CONSTRAINT FK_INMUEBLE_DISPOSICION_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_INMUEBLE_TIPO_INMUEBLE_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    DROP CONSTRAINT FK_INMUEBLE_TIPO_INMUEBLE_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_INMUEBLE_AMBIENTES_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    DROP CONSTRAINT FK_INMUEBLE_AMBIENTES_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_INMUEBLE_ESTADO_INMUEBLE_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    DROP CONSTRAINT FK_INMUEBLE_ESTADO_INMUEBLE_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_CARACTERISTICA_X_INMUEBLE_CODIGO_INMUEBLE',
             'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_X_INMUEBLE
    DROP CONSTRAINT FK_CARACTERISTICA_X_INMUEBLE_CODIGO_INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_CARACTERISTICA_X_INMUEBLE_CARACTERISTICA_INMUEBLE_ID',
             'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_X_INMUEBLE
    DROP CONSTRAINT FK_CARACTERISTICA_X_INMUEBLE_CARACTERISTICA_INMUEBLE_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ANUNCIO_AGENTE_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    DROP CONSTRAINT FK_ANUNCIO_AGENTE_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ANUNCIO_TIPO_PERIODO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    DROP CONSTRAINT FK_ANUNCIO_TIPO_PERIODO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ANUNCIO_TIPO_OPERACION_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    DROP CONSTRAINT FK_ANUNCIO_TIPO_OPERACION_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ANUNCIO_ESTADO_ANUNCIO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    DROP CONSTRAINT FK_ANUNCIO_ESTADO_ANUNCIO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ANUNCIO_INMUEBLE_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    DROP CONSTRAINT FK_ANUNCIO_INMUEBLE_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ANUNCIO_TIPO_MONEDA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    DROP CONSTRAINT FK_ANUNCIO_TIPO_MONEDA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_AGENTE_SUCURSAL_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE
    DROP CONSTRAINT FK_AGENTE_SUCURSAL_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_AGENTE_PERSONA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE
    DROP CONSTRAINT FK_AGENTE_PERSONA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_SUCURSAL_LOCALIDAD_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.SUCURSAL
    DROP CONSTRAINT FK_SUCURSAL_LOCALIDAD_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_LOCALIDAD_PROVINCIA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD
    DROP CONSTRAINT FK_LOCALIDAD_PROVINCIA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_BARRIO_LOCALIDAD_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.BARRIO
    DROP CONSTRAINT FK_BARRIO_LOCALIDAD_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_VENTA_COMPRADOR_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
    DROP CONSTRAINT FK_VENTA_COMPRADOR_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_VENTA_TIPO_MONEDA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
    DROP CONSTRAINT FK_VENTA_TIPO_MONEDA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_VENTA_ANUNCIO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
    DROP CONSTRAINT FK_VENTA_ANUNCIO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ALQUILER_INQUILINO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
    DROP CONSTRAINT FK_ALQUILER_INQUILINO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ALQUILER_ESTADO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
    DROP CONSTRAINT FK_ALQUILER_ESTADO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_ALQUILER_ANUNCIO_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
    DROP CONSTRAINT FK_ALQUILER_ANUNCIO_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_COMPRADOR_PERSONA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR
    DROP CONSTRAINT FK_COMPRADOR_PERSONA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_COMPRADOR_CODIGO_VENTA', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR
    DROP CONSTRAINT FK_COMPRADOR_CODIGO_VENTA
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_INQUILINO_PERSONA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO
    DROP CONSTRAINT FK_INQUILINO_PERSONA_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_INQUILINO_CODIGO_ALQUILER', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO
    DROP CONSTRAINT FK_INQUILINO_CODIGO_ALQUILER
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_PROPIETARIO_INMUEBLE_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO
    DROP CONSTRAINT FK_PROPIETARIO_INMUEBLE_ID
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.FK_PROPIETARIO_PERSONA_ID', 'F') IS NOT NULL
ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO
    DROP CONSTRAINT FK_PROPIETARIO_PERSONA_ID
GO
-- Fin DROP FKs

-- Inicio DROP tablas
IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DETALLE_IMPORTE_ALQ', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DETALLE_IMPORTE_ALQ
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_ALQUILER', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_ALQUILER
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ALQUILER', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ALQUILER
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MEDIO_PAGO', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MEDIO_PAGO
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_MONEDA', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_MONEDA
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DISPOSICION', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DISPOSICION
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ORIENTACION', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ORIENTACION
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_INMUEBLE', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AMBIENTES', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AMBIENTES
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_INMUEBLE', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_INMUEBLE', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_X_INMUEBLE', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_X_INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_PERIODO', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_PERIODO
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_OPERACION', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_OPERACION
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ANUNCIO', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ANUNCIO
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.SUCURSAL', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.SUCURSAL
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROVINCIA', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROVINCIA
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.BARRIO', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.BARRIO
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO', 'U') IS NOT NULL
    DROP TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO
GO
-- Fin DROP tablas

-- Inicio DROP Funciones

-- Fin DROP Funciones

-- Inicio DROP Procedimientos
IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_EJEMPLO_SP') IS NOT NULL
    DROP PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_EJEMPLO_SP
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_DISPOSICION') IS NOT NULL
    DROP PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_DISPOSICION
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_DISPOSICION') IS NOT NULL
    DROP PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_AMBIENTES
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ESTADO_INMUEBLE') IS NOT NULL
    DROP PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ESTADO_INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_TIPO_INMUEBLE') IS NOT NULL
    DROP PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_TIPO_INMUEBLE
GO

IF OBJECT_ID('LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ORIENTACION') IS NOT NULL
    DROP PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ORIENTACION
GO

-- Fin DROP Procedimientos

-- Inicio crear schema de la aplicación
IF EXISTS (SELECT SCHEMA_NAME
           FROM INFORMATION_SCHEMA.SCHEMATA
           WHERE SCHEMA_NAME = 'LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO')
    DROP SCHEMA LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO
GO

CREATE SCHEMA LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO
GO
-- Fin crear schema de la aplicación

-- Inicio crear tablas
CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DETALLE_IMPORTE_ALQ
(
    codigo             NUMERIC(19, 0) PRIMARY KEY,
    alquiler_id        NUMERIC(19, 0) NOT NULL,
    nro_periodo_inicio NUMERIC(19, 2) NULL,
    nro_periodo_fin    NUMERIC(19, 2) NULL,
    precio             NUMERIC(19, 2) NULL,
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_ALQUILER
(
    codigo            NUMERIC(19, 0) PRIMARY KEY,
    alquiler_id       NUMERIC(19, 0) NOT NULL,
    fecha_pago        DATETIME       NULL,
    nro_periodo_pago  NUMERIC(19, 0) NULL,
    descripcion       NVARCHAR(100)  NULL,
    fecha_inicio_pago DATETIME       NULL,
    fecha_fin_pago    DATETIME       NULL,
    importe           NUMERIC(19, 0) NULL,
    medio_pago_id     NUMERIC(19, 0) NOT NULL,
    fecha_vencimiento DATETIME       NULL,
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
(
    codigo         NUMERIC(19, 0) PRIMARY KEY,
    importe        NUMERIC(19, 2) NULL,
    tipo_moneda_id NUMERIC(19, 0) NOT NULL,
    cotizacion     NUMERIC(19, 2) NULL,
    medio_pago_id  NUMERIC(19, 0) NOT NULL,
    venta_id       NUMERIC(19, 0) NOT NULL,
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ALQUILER
(
    id          NUMERIC(19, 0) PRIMARY KEY,
    descripcion NVARCHAR(100) NULL
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MEDIO_PAGO
(
    id          NUMERIC(19, 0) PRIMARY KEY,
    descripcion NVARCHAR(100) NULL
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_MONEDA
(
    id          NUMERIC(19, 0) PRIMARY KEY,
    descripcion NVARCHAR(100) NULL
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
(
    codigo             NUMERIC(19, 0) PRIMARY KEY,
    tipo_inmueble_id   NUMERIC(19, 0),
    descripcion        NVARCHAR(100),
    nombre             NVARCHAR(100),
    propietario_id     NUMERIC(19, 0),
    barrio_id          NUMERIC(19, 0),
    ambientes_id       NUMERIC(19, 0),
    superficie_total   NUMERIC(19, 0),
    disposicion_id     NUMERIC(19, 0),
    orientacion_id     NUMERIC(19, 0),
    estado_inmueble_id NUMERIC(19, 0),
    antiguedad         NUMERIC(19, 0),
    expensas           NUMERIC(19, 0)
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ORIENTACION
(
    id          NUMERIC(19, 0) IDENTITY (1, 1) PRIMARY KEY,
    descripcion NVARCHAR(100),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DISPOSICION
(
    id          NUMERIC(19, 0) IDENTITY (1, 1) PRIMARY KEY,
    descripcion NVARCHAR(100)
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_INMUEBLE
(
    id          NUMERIC(19, 0) IDENTITY (1, 1) PRIMARY KEY,
    descripcion NVARCHAR(100)
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AMBIENTES
(
    id          NUMERIC(19, 0) IDENTITY (1, 1) PRIMARY KEY,
    descripcion NVARCHAR(100)
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_INMUEBLE
(
    id          NUMERIC(19, 0) IDENTITY (1, 1) PRIMARY KEY,
    descripcion NVARCHAR(100)
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_INMUEBLE
(
    id          NUMERIC(19, 0) IDENTITY (1, 1) PRIMARY KEY,
    descripcion NVARCHAR(100),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_X_INMUEBLE
(
    codigo_inmueble            NUMERIC(19, 0),
    caracteristica_inmueble_id NUMERIC(19, 0),
    PRIMARY KEY (codigo_inmueble, caracteristica_inmueble_id),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_PERIODO
(
    id          NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    descripcion NVARCHAR(100),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_OPERACION
(
    id          NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    descripcion NVARCHAR(100),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ANUNCIO
(
    id          NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    descripcion NVARCHAR(100),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROVINCIA
(
    id          NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    descripcion NVARCHAR(100),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD
(
    id           NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    descripcion  NVARCHAR(100),
    provincia_id NUMERIC(19, 0),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.BARRIO
(
    id           NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    descripcion  NVARCHAR(100),
    localidad_id NUMERIC(19, 0),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.SUCURSAL
(
    codigo       NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    direccion    NVARCHAR(100),
    localidad_id NUMERIC(19, 0),
    nombre       NVARCHAR(100),
    telefono     NVARCHAR(100),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE
(
    id          NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    persona_id  NUMERIC(19, 0),
    sucursal_id NUMERIC(19, 0),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
(
    codigo                    NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    agente_id                 NUMERIC(19, 0),
    costo_publicacion_anuncio NUMERIC(19, 2),
    estado_anuncio_id         NUMERIC(19, 0),
    fecha_finalizacion        DATETIME,
    fecha_publicacion         DATETIME,
    inmueble_id               NUMERIC(19, 0),
    precio_publicado          NUMERIC(19, 2),
    tipo_moneda_id            NUMERIC(19, 0),
    tipo_operacion_id         NUMERIC(19, 0),
    tipo_periodo_id           NUMERIC(19, 0),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA
(
    id             NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    apellido       NVARCHAR(100),
    dni            NUMERIC(19, 0),
    fecha_nac      DATETIME,
    fecha_registro DATETIME,
    mail           NVARCHAR(100),
    nombre         NVARCHAR(100),
    telefono       NUMERIC(19, 0),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
(
    codigo         NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    comprador_id   NUMERIC(19, 0),
    fecha_venta    DATETIME,
    precio_venta   NUMERIC(19, 2),
    tipo_moneda_id NUMERIC(19, 0) NOT NULL,
    comision       NUMERIC(19, 2),
    anuncio_id     NUMERIC(19, 0),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
(
    codigo                NUMERIC(19, 0) IDENTITY (1,1) PRIMARY KEY,
    inquilino_id          NUMERIC(19, 0),
    fecha_inicio_alquiler DATETIME,
    fecha_fin_alquiler    DATETIME,
    cant_periodos         NUMERIC(19, 0),
    deposito              NUMERIC(19, 2),
    comision              NUMERIC(19, 2),
    gastos_averiguaciones NUMERIC(19, 2),
    estado_id             NUMERIC(19, 0),
    anuncio_id            NUMERIC(19, 0),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR
(
    persona_id   NUMERIC(19, 0),
    codigo_venta NUMERIC(19, 0),
    PRIMARY KEY (persona_id, codigo_venta),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO
(
    persona_id      NUMERIC(19, 0),
    codigo_alquiler NUMERIC(19, 0),
    PRIMARY KEY (persona_id, codigo_alquiler),
)
GO

CREATE TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO
(
    persona_id  NUMERIC(19, 0),
    inmueble_id NUMERIC(19, 0),
    PRIMARY KEY (persona_id, inmueble_id),
)
GO
-- Fin crear tablas

-- Inicio crear FKs

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DETALLE_IMPORTE_ALQ
    ADD CONSTRAINT FK_DETALLE_IMPORTE_ALQ_ALQUILER_ID FOREIGN KEY (alquiler_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER (codigo)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_ALQUILER
    ADD CONSTRAINT FK_PAGO_ALQUILER_ALQUILER_ID FOREIGN KEY (alquiler_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER (codigo)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_ALQUILER
    ADD CONSTRAINT FK_PAGO_ALQUILER_MEDIO_PAGO_ID FOREIGN KEY (MEDIO_PAGO_ID) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MEDIO_PAGO (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
    ADD CONSTRAINT FK_PAGO_VENTA_TIPO_MONEDA_ID FOREIGN KEY (tipo_moneda_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_MONEDA (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
    ADD CONSTRAINT FK_PAGO_VENTA_MEDIO_PAGO_ID FOREIGN KEY (medio_pago_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MEDIO_PAGO (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PAGO_VENTA
    ADD CONSTRAINT FK_PAGO_VENTA_VENTA_ID FOREIGN KEY (venta_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA (codigo)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    ADD CONSTRAINT FK_INMUEBLE_ORIENTACION_ID FOREIGN KEY (orientacion_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ORIENTACION (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    ADD CONSTRAINT FK_INMUEBLE_DISPOSICION_ID FOREIGN KEY (disposicion_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DISPOSICION (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    ADD CONSTRAINT FK_INMUEBLE_TIPO_INMUEBLE_ID FOREIGN KEY (tipo_inmueble_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_INMUEBLE (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    ADD CONSTRAINT FK_INMUEBLE_AMBIENTES_ID FOREIGN KEY (ambientes_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AMBIENTES (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE
    ADD CONSTRAINT FK_INMUEBLE_ESTADO_INMUEBLE_ID FOREIGN KEY (estado_inmueble_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_INMUEBLE (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_X_INMUEBLE
    ADD CONSTRAINT FK_CARACTERISTICA_X_INMUEBLE_CODIGO_INMUEBLE FOREIGN KEY (codigo_inmueble) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE (codigo)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_X_INMUEBLE
    ADD CONSTRAINT FK_CARACTERISTICA_X_INMUEBLE_CARACTERISTICA_INMUEBLE_ID FOREIGN KEY (caracteristica_inmueble_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.CARACTERISTICA_INMUEBLE (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    ADD CONSTRAINT FK_ANUNCIO_AGENTE_ID FOREIGN KEY (agente_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    ADD CONSTRAINT FK_ANUNCIO_TIPO_PERIODO_ID FOREIGN KEY (tipo_periodo_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_PERIODO (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    ADD CONSTRAINT FK_ANUNCIO_TIPO_OPERACION_ID FOREIGN KEY (tipo_operacion_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_OPERACION (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    ADD CONSTRAINT FK_ANUNCIO_ESTADO_ANUNCIO_ID FOREIGN KEY (estado_anuncio_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ANUNCIO (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    ADD CONSTRAINT FK_ANUNCIO_INMUEBLE_ID FOREIGN KEY (inmueble_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE (codigo)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO
    ADD CONSTRAINT FK_ANUNCIO_TIPO_MONEDA_ID FOREIGN KEY (tipo_moneda_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_MONEDA (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE
    ADD CONSTRAINT FK_AGENTE_SUCURSAL_ID FOREIGN KEY (sucursal_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.SUCURSAL (codigo)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AGENTE
    ADD CONSTRAINT FK_AGENTE_PERSONA_ID FOREIGN KEY (persona_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.SUCURSAL
    ADD CONSTRAINT FK_SUCURSAL_LOCALIDAD_ID FOREIGN KEY (localidad_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD
    ADD CONSTRAINT FK_LOCALIDAD_PROVINCIA_ID FOREIGN KEY (provincia_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROVINCIA (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.BARRIO
    ADD CONSTRAINT FK_BARRIO_LOCALIDAD_ID FOREIGN KEY (localidad_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
    ADD CONSTRAINT FK_VENTA_COMPRADOR_ID FOREIGN KEY (comprador_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
    ADD CONSTRAINT FK_VENTA_TIPO_MONEDA_ID FOREIGN KEY (tipo_moneda_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA
    ADD CONSTRAINT FK_VENTA_ANUNCIO_ID FOREIGN KEY (anuncio_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
    ADD CONSTRAINT FK_ALQUILER_INQUILINO_ID FOREIGN KEY (inquilino_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
    ADD CONSTRAINT FK_ALQUILER_ESTADO_ID FOREIGN KEY (estado_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER
    ADD CONSTRAINT FK_ALQUILER_ANUNCIO_ID FOREIGN KEY (anuncio_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR
    ADD CONSTRAINT FK_COMPRADOR_PERSONA_ID FOREIGN KEY (persona_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR
    ADD CONSTRAINT FK_COMPRADOR_CODIGO_VENTA FOREIGN KEY (codigo_venta) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO
    ADD CONSTRAINT FK_INQUILINO_PERSONA_ID FOREIGN KEY (persona_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO
    ADD CONSTRAINT FK_INQUILINO_CODIGO_ALQUILER FOREIGN KEY (codigo_alquiler) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO
    ADD CONSTRAINT FK_PROPIETARIO_PERSONA_ID FOREIGN KEY (persona_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO

ALTER TABLE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO
    ADD CONSTRAINT FK_PROPIETARIO_INMUEBLE_ID FOREIGN KEY (inmueble_id) REFERENCES LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.LOCALIDAD (id)
GO
-- Fin crear FKs

/*-- Inicio crear Funciones
--COMPRADOR
CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_COMPRADOR
AS
BEGIN 

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR(persona_id, codigo_venta)
  SELECT DISTINCT p.id, m.VENTA_CODIGO
  FROM gd_esquema.Maestra m
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA p ON p.id = 
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA v ON v.codigo = m.VENTA_CODIGO

END 
GO
--INQUILINO
CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_INQUILINO
AS
BEGIN 

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO(persona_id, codigo_venta)
  SELECT DISTINCT p.id, m.ALQUILER_CODIGO
  FROM gd_esquema.Maestra m
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA p ON p.id = 
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER a ON a.codigo = m.ALQUILER_CODIGO

END 
GO
--PROPIETARIO
CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_PROPIETARIO
AS
BEGIN 

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROPIETARIO(persona_id, codigo_venta)
  SELECT DISTINCT p.id, m.INMUEBLE_CODIGO
  FROM gd_esquema.Maestra m
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA p ON p.id = 
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INMUEBLE i ON i.codigo = m.INMUEBLE_CODIGO

END 
GO
--PERSONA (falta ver como mapear el id de persona)
CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_PERSONA
AS
BEGIN 

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA(id, apellido, dni, fecha_nac, fecha_registro, mail, nombre, telefono)
  SELECT DISTINCT COMPRADOR_APELLIDO, COMPRADOR_DNI, COMPRADOR_FECHA_NAC, COMPRADOR_FECHA_REGISTRO, COMPRADOR_MAIL, COMPRADOR_NOMBRE, COMPRADOR_TELEFONO
  FROM gd_esquema.Maestra

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA(id, apellido, dni, fecha_nac, fecha_registro, mail, nombre, telefono)
  SELECT DISTINCT INQUILINO_APELLIDO, INQUILINO_DNI, INQUILINO_FECHA_NAC, INQUILINO_FECHA_REGISTRO, INQUILINO_MAIL, INQUILINO_NOMBRE, INQUILINO_TELEFONO
  FROM gd_esquema.Maestra

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PERSONA(id, apellido, dni, fecha_nac, fecha_registro, mail, nombre, telefono)
  SELECT DISTINCT PROPIETARIO_APELLIDO, PROPIETARIO_DNI, PROPIETARIO_FECHA_NAC, PROPIETARIO_FECHA_REGISTRO, PROPIETARIO_MAIL, PROPIETARIO_NOMBRE, PROPIETARIO_TELEFONO
  FROM gd_esquema.Maestra
END 
GO
--VENTA (falta mapear id de persona y de tipo moneda)
CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_VENTA
AS
BEGIN 

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.VENTA(codigo, comprador_id, fecha_venta, precio_venta, tipo_moneda_id, comision, anuncio_id)
  SELECT DISTINCT VENTA_CODIGO, c.persona_id, VENTA_FECHA, VENTA_PRECIO_VENTA, tm.id, VENTA_COMISION, a.codigo
  FROM gd_esquema.Maestra m
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.COMPRADOR c ON c.persona_id = 
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_MONEDA tm ON tm.id = 
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO a ON a.codigo = m.ANUNCIO_CODIGO
END 
GO
--ALQUILER
CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ALQUILER
AS
BEGIN 

  INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ALQUILER(codigo, inquilino_id, fecha_inicio_alquiler, fecha_fin_alquiler, cant_periodos, deposito, comision, gastos_averiguaciones, estado_id, anuncio_id)
  SELECT DISTINCT ALQUILER_CODIGO, i.persona_id, ALQUILER_FECHA_INICIO, ALQUILER_FECHA_FIN, ALQUILER_CANT_PERIODOS, ALQUILER_DEPOSITO, ALQUILER_COMISION, ALQUILER_GASTOS_AVERIGUA, ea.id, a.codigo
  FROM gd_esquema.Maestra m
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.INQUILINO i ON i.persona_id = 
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_ALQUILER ea ON ea.id = m.ALQUILER_ESTADO 
  JOIN LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ANUNCIO a ON a.codigo = m.ANUNCIO_CODIGO
END 
GO

-- Fin crear Funciones*/

-- Inicio crear Procedimientos
/*
CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_EJEMPLO_SP
AS
BEGIN
    -- Cuerpo
    SELECT 1
END
GO

CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_DISPOSICION
AS
BEGIN
    INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.DISPOSICION(descripcion)
    SELECT DISTINCT INMUEBLE_DISPOSICION
    FROM GD_ESQUEMA.MAESTRA
    WHERE INMUEBLE_DISPOSICION IS NOT NULL
END
GO

CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_AMBIENTES
AS
BEGIN
    INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.AMBIENTES(descripcion)
    SELECT DISTINCT INMUEBLE_CANT_AMBIENTES
    FROM GD_ESQUEMA.MAESTRA
    WHERE INMUEBLE_CANT_AMBIENTES IS NOT NULL
END
GO

CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ESTADO_INMUEBLE
AS
BEGIN
    INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ESTADO_INMUEBLE(descripcion)
    SELECT DISTINCT INMUEBLE_ESTADO
    FROM GD_ESQUEMA.MAESTRA
    WHERE INMUEBLE_ESTADO IS NOT NULL
END
GO

CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_TIPO_INMUEBLE
AS
BEGIN
    INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.TIPO_INMUEBLE(descripcion)
    SELECT DISTINCT INMUEBLE_TIPO_INMUEBLE
    FROM GD_ESQUEMA.MAESTRA
    WHERE INMUEBLE_TIPO_INMUEBLE IS NOT NULL
END
GO

CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ORIENTACION
AS
BEGIN
    INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.ORIENTACION(descripcion)
    SELECT DISTINCT INMUEBLE_ORIENTACION
    FROM GD_ESQUEMA.MAESTRA
    WHERE INMUEBLE_ORIENTACION IS NOT NULL
END
GO

CREATE PROCEDURE LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_PROVINCIA
AS
BEGIN
    INSERT INTO LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.PROVINCIA(descripcion)
    SELECT DISTINCT GD_ESQUEMA.MAESTRA.INMUEBLE_PROVINCIA
    FROM GD_ESQUEMA.MAESTRA
    WHERE INMUEBLE_PROVINCIA IS NOT NULL
END
GO

-- Fin crear Procedimientos

-- Inicio Invocaciones de procedimientos
EXEC LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_EJEMPLO_SP

EXEC LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_DISPOSICION

EXEC LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_AMBIENTES

EXEC LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ESTADO_INMUEBLE

EXEC LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_TIPO_INMUEBLE

EXEC LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_ORIENTACION

EXEC LOS_HEREDEROS_DE_MONTIEL_Y_EL_DATO_PERSISTIDO.MIGRAR_PROVINCIA
*/

GO
-- Fin Invocaciones de procedimientos